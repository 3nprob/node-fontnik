language: node_js

node_js:
 - "0.10"

env:
  global:
  - BUILD: '/tmp/fontserver-build'
  - PKG_CONFIG_PATH: '/tmp/fontserver-build/lib/pkgconfig'


before_install:
 - sudo add-apt-repository -y ppa:boost-latest/ppa
 - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test; sudo apt-get update; sudo apt-get install boost1.55 gcc-4.8 g++-4.8; export CXX=g++-4.8
 - mkdir -p $BUILD
 - ./deps/build_icu.sh 1>> build.log
 - ./deps/build_protobuf.sh 1>> build.log
 - ./deps/build_freetype.sh 1>> build.log
 - ./deps/build_harfbuzz.sh 1>> build.log
 - export PATH="$BUILD/bin:$PATH"
 - echo "PKG_CONFIG_PATH is set to $PKG_CONFIG_PATH"
 - ls /tmp/fontserver-build/lib/pkgconfig

install:
 - echo $CXX
 - npm install

script:
 - npm test

